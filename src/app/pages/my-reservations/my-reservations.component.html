<h2 class="title">Moje rezervacije</h2>

<div *ngIf="rezervacije.length === 0" class="empty">
  <p>Nemate nijednu rezervaciju.</p>
</div>

<div class="table-wrapper" *ngIf="rezervacije.length > 0">
  <table class="rez-table">
    <thead>
      <tr>
        <th>Slika</th>
        <th>Naziv</th>
        <th>Status</th>
        <th>Cena</th>
        <th>Ocena</th>
        <th>Akcije</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let r of rezervacije">
        <td><img [src]="r.pet.slikaUrl" alt="{{ r.pet.naziv }}" /></td>
        <td>{{ r.pet.naziv }}</td>
        <td>
          <span class="status" [ngClass]="r.status">{{ r.status }}</span>
        </td>
        <td>{{ r.pet.cena | currency:'RSD' }}</td>
        <td>
          <ng-container *ngIf="r.status === 'preuzeto' && r.ocena !== undefined">
            <div class="paw-container">
              <ng-container *ngFor="let i of [1,2,3,4,5]">
                <div class="paw-wrapper">
                  <lucide-icon name="paw-print" class="paw-base"></lucide-icon>
                  <lucide-icon name="paw-print" class="paw-overlay" [style.width.%]="getPawPercent(r.ocena ?? 0, i)"></lucide-icon>
                </div>
              </ng-container>
              <span class="ocena-text">({{ r.ocena }}/5)</span>
            </div>
          </ng-container>
        </td>
        <td>
          <div class="actions">
            <button *ngIf="r.status === 'u toku'" class="btn primary" (click)="preuzmi(r)">✅</button>
            <button *ngIf="r.status === 'u toku'" class="btn danger" (click)="otkazi(r)">X</button>
            <button *ngIf="r.status === 'otkazano'" class="btn secondary" (click)="vrati(r)">♻️</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
